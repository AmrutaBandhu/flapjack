#!/usr/bin/env ruby

$: << File.dirname(__FILE__) + '/../lib' unless $:.include?(File.dirname(__FILE__) + '/../lib/')

require 'flapjack/cli/notifier'
require 'flapjack/applications/notifier'
require 'daemons'
require 'flapjack/patches'

@options = Flapjack::NotifierOptions.parse(ARGV)

log = Log4r::Logger.new("notifier")
log.add(Log4r::StdoutOutputter.new("notifier"))
log.add(Log4r::SyslogOutputter.new("notifier"))

app = Flapjack::Notifier::Application.run(:log => log, 
                                          :notifiers => {},
                                          :queue_backend => {:type => :beanstalkd},
                                          :persistence => {:type => :datamapper,
                                                           :uri => "sqlite3:///tmp/flapjack.db"})
app.main()

